---
layout: post
title: <데이터베이스> 9. 정규화(Normalization)
subtitle: Engineer Information Processing
author: Jo
categories: CS
banner:
  image: https://github.com/CheeseYoung/Cheeseyoung.github.io/assets/132384527/8ab52fa9-b61b-4ad5-ab7e-13641a30998d
  opacity: 0.618
  background: "#000"
  height: "100vh"
  min_height: "38vh"
  heading_style: "font-size: 4.25em; font-weight: bold; text-decoration: underline"
  subheading_style: "color: gold"
tags: Study

---


# 목차
🕳 키(Key) <br>
🕳 인덱스(Index) <br>
📌 정규화(Normalization) <br>
🕳 트랜잭션(Transaction) <br>
🕳 이상현상(Anomaly) <br>
🕳 병행제어(Concurrency Control) <br>
<br>
<hr>

> 정처기 때문에 도부이결다조로 외웠던 정규화


## 정규화(Normalization)란?
**이상현상이 발생하는 릴레이션을 분해하여 이상현상을 없애는 과정**
- 이상현상이 존재하는 릴레이션을 분해하여 여러 개의 릴레이션을 생성하게 된다.
- 이를 구분하여 정규형이 높아질수록 이상현상은 줄어들게 된다.
- 정규화(Normalization)의 기본 목표는 **테이블 간에 중복된 데이터를 허용하지 않는다는 것**이다. 
- 이로써 **무결성(Integrity)를 유지**할 수 있으며, **DB의 저장 용량 역시 줄일 수 있다**.
- 이러한 테이블을 분해하는 정규화 단계가 정의되어 있다.

## 정규화의 장단점
# 장점
- 데이터베이스 변경 시 이상 현상(Anomaly)을 제거할 수 있다.
- 정규화된 데이터베이스 구조에서는 새로운 데이터 형의 추가로 인한 확장 시, 그 구조를 변경하지 않아도 되거나 일부만 변경해도 된다.
- 데이터베이스와 연동된 응용 프로그램에 최소한의 영향만을 미치게 되어 응용프로그램의 생명을 연장시킨다.
<br><br>

# 단점
- 릴레이션의 분해로 인해 릴레이션 간의 JOIN 연산이 많아진다.
- 질의에 대한 응답 시간이 느려질 수도 있다.
  - 데이터의 중복 속성을 제거하고 결정자에 의해 동일한 의미의 일반 속성이 하나의 테이블로 집약되므로
  - 한 테이블의 데이터 용량이 최소화되는 효과가 있다.
- 따라서 데이터를 처리할 때 속도가 빨라질 수도 있고 느려질 수도 있다.
- 만약 조인이 많이 발생하여 성능 저하가 나타나면 반정규화(De-normalization)를 적용할 수도 있다.


## 제 1정규화(1NF)
# 테이블의 컬럼이 원자값(Atomic Value, 하나의 값)을 갖도록 테이블을 분해하는 것
제 1 정규화는 다음과 같은 규칙들을 만족해야한다.
1. 각 컬럼이 하나의 속성만을 가져야한다.
2. 하나의 컬럼은 같은 종류나 타입(type)의 값을 가져야한다.
3. 각 컬럼이 유일한 이름을 가져야한다.
4. 칼럼의 순서가 상관없어야한다

- 예를 들면,

|이름|나이|수강과목|
|--|--|--|
|조|25|C,C++|
|영|26|Java|
|은|27|Python,Oracle|

위와 같은 표를

|이름|나이|수강과목|
|--|--|--|
|조|25|C|
|조|25|C++|
|영|26|Java|
|은|27|Python|
|은|27|Oracle|

이렇게 고치는 것이다.

## 제 2정규화(2NF)
# 제1 정규화를 진행한 테이블에 대해 완전 함수 종속을 만족하도록 테이블을 분해하는 것
- 완전 함수 종속이라는 것은 기본키의 부분집합이 결정자가 되어선 안된다는 것을 의미
- 제 2정규화는 다음과 같은 규칙을 만족해야한다.
  1. 제 1정규화를 만족해야한다.
  2. 모든 컬럼이 **부분적 종속(Partial Dependency)이 없어야한다.** 모든 칼럼이 완전 함수 종속을 만족해야한다.

- 제 1 정규화가 적용된 예시를 2정규화를 하면,

|이름|나이|
|--|--|
|조|25|
|영|26|
|은|27|

이 테이블과,

|이름|수강과목|
|--|--|
|조|C|
|조|C++|
|영|Java|
|은|Python|
|은|Oracle|

이 테이블로 나누는 것이다.

## 제 3정규화
# 제 2정규화를 진행한 테이블에 대해 이행적 종속을 없애도록 테이블을 분해하는 것
- 이행적 종속이라는 것은 A->B, B->C가 성립할 때 A->C가 성립되는 것을 의미
- 제 3정규화는 다음과 같은 규칙을 만족해야 한다.
  1. 제 2 정규화를 만족해야한다.
  2. 기본키를 제외한 속성들 간의 **이행 종속성(Transitive Dependency)이 없어야한다.**
 
- ex) 아래와 같은 테이블이 있다고 가정하자

|사번|이름|Street|City|State|ZIP|
|--|--|--|--|--|--|
|||||||

- 사번이 기본키이고, 기본키가 하나이므로 2차 정규형은 만족한다.
- 하지만 ZIP(우편번호) 컬럼을 알면 Street, City, State 컬럼을 결정할 수 있다.
- 또한, 동일한 ZIP코드를 가지면, 동일한 Street, City, State를 가지므로, 중복된 데이터가 생길 가능성이 있다.
- 그러므로, 제 3정규화를 통해

|사번|이름|ZIP|
|--|--|--|
||||

테이블과

|ZIP|Street|City|State|
|--|--|--|--|
||||

테이블로 나누면 제 3정규화를 만족한다.

## BCNF(Boyce-codd Normal Form)
# BCNF란 3차 정규화를 만족하면서 모든 결정자가 후보키 집합에 속한 정규형이다.
BCNF는 다음과 같은 규칙을 만족해야 한다.
1. 제 3 정규화를 만족해야 한다.
2. 모든 결정자가 후보키 집합에 속해야 한다.

- 예를 들면,
- 
|학생|과목|교수|학점|
|--|--|--|--|
|1|Java|Ms.Jo|A|
|2|Python|Maru|A|
|3|Python|Maru|B|

- 위와 같이 테이블이 구성된 경우에 데이터가 중복되고, 갱신 이상이 발생한다.
- 정규화를 통해

|교수|과목|
|--|--|
|Ms.Jo|Java|
|Maru|Python|

교수 테이블과 

|학생|과목|학점|
|--|--|--|
|1|Java|A|
|2|Python|A|
|3|Python|B|

수강 테이블로 나누면, BCNF 정규화를 만족하게 된다.

<br>
- 보통 정규화는 BCNF까지만 하는 경우가 많다.
- 그 이상 정규화를 하면 정규화의 단점이 나타날 수도 있다.

## 제 4정규화(4NF)
제4 정규형은 다음과 같은 규칙을 만족해야 한다. 
1. BCNF를 만족해야 한다.
2. **다치 종속(Multi-valued Dependency)이 없어야** 한다.
- 다치 종속이란?
  - A->B 일 때 하나의 A값에 여러 개의 B값이 존재하면 다치 종속성을 가진다고 하고 A↠B라고 표시한다.
  - 최소 3개의 칼럼이 존재한다.
  - R(A, B, C)가 있을 때 A와 B 사이에 다치 종속성이 있을 때 B와 C가 독립적이다.

- 예를 들면

|학생|과목|취미|
|--|--|--|
|101|Java|노래|
|101|C++|게임|
|102|DB|노래|
|102|Python|게임|

- 위의 테이블을 보면, 학생 하나에 과목 여러 개와 취미 여러 개가 종속된다.
- 이렇게 되면 학생 번호를 토대로 값을 조회하면 아래와 같이 값의 중복이 발생하게 된다.

|학생|과목|취미|
|--|--|--|
|101|Java|노래|
|101|Java|게임|
|101|C++|노래|
|101|C++|게임|

- 과목과 취미는 관계가 없는 독립적인 관계다.
- 하지만 같은 테이블의 학생이라는 칼럼에 다치 종속되어버려 중복이 발생하는 문제가 생긴다.
- 이러한 문제를 해결하기 위해서는 아래와 같이 분해해야한다.

|학생|과목|
|--|--|
|101|Java|
|101|C++|
|102|DB|
|102|Python|


|학생|취미|
|--|--|
|101|노래|
|101|게임|
|102|노래|
|102|게임|

- 위 2개의 테이블은 여전히 다치 종속성을 가지지만, 2개 이상의 칼럼이 하나의 칼럼에 다치 종속되지는 않기 때문에 제4 정규형을 만족한다.

## 제5 정규형(5NF)
# 제5 정규형은 중복을 제거하기 위해 분해할 수 있을 만큼 전부 분해하는 것
- 이러한 5NF는 Project Join Normal Form(PJNF)라고도 불린다.
- 제 5정규형은 다음과 같은 규칙을 만족해야 한다.
  1. 4NF를 만족해야 한다.
  2. 조인 종속(Join dependency)이 없어야 한다.
  3. 조인 연산을 했을 때 손실이 없어야 한다.
- 조인 종속은 다치 종속의 좀 더 일반화된 형태이다.
- 만약 하나의 릴레이션을 여러 개의 릴레이션으로 무손실 분해했다가 다시 결합할 수 있다면 조인 종속이라고 한다. 







